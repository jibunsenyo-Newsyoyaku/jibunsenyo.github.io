<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>My News</title>
<style>
body {
  background: #000;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
}
button {
  position: fixed;
  top: 10px;
  right: 10px;
}
.item {
  display: flex;
  gap: 12px;
  padding: 12px;
  border-bottom: 1px solid #333;
}
.item img {
  width: 64px;
  height: 64px;
  background: #444;
  object-fit: cover;
}
.source {
  font-size: 12px;
  opacity: 0.7;
}
.title {
  font-size: 15px;
}
</style>
</head>

<body>
<button onclick="loadNews()">更新</button>
<div id="news"></div>

<script>
async function loadNews() {
  const url = `https://jibunsenyo.github.io/news.json?ts=${Date.now()}`;

  const res = await fetch(url, {
    cache: "no-store",
    headers: { "Cache-Control": "no-cache" }
  });

  const news = await res.json();
  const el = document.getElementById("news");
  el.innerHTML = "";

  news.forEach(n => {
    el.innerHTML += `
      <div class="item">
        <img src="${n.image || 'https://dummyimage.com/64x64/444/fff'}">
        <div>
          <div class="source">${n.source}</div>
          <div class="title">${n.title}</div>
        </div>
      </div>
    `;
  });
}

// 初回表示
loadNews();

// アプリ再表示時にも自動更新
document.addEventListener("visibilitychange", () => {
  if (!document.hidden) loadNews();
});
</script>
</body>
</html>
