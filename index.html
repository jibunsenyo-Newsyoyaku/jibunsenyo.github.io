<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>今日のニュース</title>

<meta name="apple-mobile-web-app-capable" content="yes">

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #fff;
  color: #000;
}
@media (prefers-color-scheme: dark) {
  body { background:#000; color:#fff; }
}

#reload {
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 5;
}

#splash {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: inherit;
}

.spinner {
  width: 32px;
  height: 32px;
  border: 3px solid rgba(0,0,0,.2);
  border-top-color: rgba(0,0,0,.8);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 12px;
}
@media (prefers-color-scheme: dark) {
  .spinner {
    border: 3px solid rgba(255,255,255,.2);
    border-top-color: rgba(255,255,255,.8);
  }
}
@keyframes spin { to { transform: rotate(360deg); } }

ul {
  list-style: none;
  padding: 16px;
  margin: 0;
  display: none;
}

li {
  display: flex;
  gap: 12px;
  padding: 12px 0;
  border-bottom: 1px solid #e0e0e0;
}
@media (prefers-color-scheme: dark) {
  li { border-bottom: 1px solid #333; }
}

.thumb {
  width: 72px;
  height: 72px;
  border-radius: 8px;
  background: #ccc;
  object-fit: cover;
  flex-shrink: 0;
}

.source {
  font-size: 12px;
  opacity: .6;
  margin-bottom: 4px;
}

a {
  color: inherit;
  text-decoration: none;
  font-size: 15px;
}
</style>
</head>

<body>
<button id="reload">更新</button>

<div id="splash">
  <div class="spinner"></div>
  <div>ロード中…</div>
</div>

<ul id="news"></ul>

<script>
  console.log("JS loaded");
document.getElementById("reload").onclick = () => {
  location.reload(true);
};

fetch("news.json")
  .then(res => res.json())
  .then(items => {
    const list = document.getElementById("news");

    items.forEach(item => {
      const li = document.createElement("li");

      const img = document.createElement("img");
      img.className = "thumb";
      img.src = item.image || "https://via.placeholder.com/150?text=News";
      img.onerror = () => {
        img.src = "https://via.placeholder.com/150?text=News";
      };

      const box = document.createElement("div");

      const source = document.createElement("div");
      source.className = "source";
      source.textContent = item.source || "";

      const a = document.createElement("a");
      a.href = item.link;
      a.textContent = item.title;
      a.target = "_blank";

      box.appendChild(source);
      box.appendChild(a);

      li.appendChild(img);
      li.appendChild(box);
      list.appendChild(li);
    });

    document.getElementById("splash").style.display = "none";
    list.style.display = "block";
  })
  .catch(() => {
    document.getElementById("splash").innerText = "読み込み失敗";
  });
</script>
</body>
</html>
